<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>PlanDaVoyage — Maharashtra</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{box-sizing:border-box;font-family:'Segoe UI',Tahoma,sans-serif}
body{margin:0;background:linear-gradient(135deg,#0a0f2c,#1a0033);color:#e6e6ff}

@keyframes pulse{
  0%{opacity:1}
  50%{opacity:.6}
  100%{opacity:1}
}
.warning{
  background:#ff004c;
  color:#fff;
  text-align:center;
  padding:10px;
  font-weight:bold;
  animation:pulse 2s infinite;
}

header{text-align:center;padding:30px}
header h1{font-size:3rem;color:#b388ff;text-shadow:0 0 15px #7f5cff}
header p{color:#c7bfff}

.chat-box{
  max-width:700px;
  margin:20px auto 60px;
  background:rgba(15,5,35,0.95);
  border-radius:20px;
  padding:20px;
  box-shadow:0 0 40px #5b2cff;
  display:flex;
  flex-direction:column;
}

.messages{
  flex:1;
  overflow-y:auto;
  max-height:400px;
  padding-right:10px;
}

.message{
  margin:10px 0;
  padding:12px 18px;
  border-radius:15px;
  max-width:100%;
  word-wrap:break-word;
  line-height:1.4;
}

.bot{background:#2a145f;box-shadow:0 0 15px #7f5cff}
.user{background:#00d4ff;color:#000;margin-left:auto;box-shadow:0 0 15px #00d4ff}

.input-area{display:flex;gap:10px;margin-top:15px}
input{
  flex:1;
  padding:12px;
  border-radius:10px;
  border:none;
  background:#120826;
  color:#fff;
  outline:none;
  font-size:1rem;
}
button{
  padding:12px 20px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  background:linear-gradient(90deg,#7f00ff,#00d4ff);
  font-weight:bold;
}

.itinerary-item{
  cursor:pointer;
  background:rgba(30,10,60,0.9);
  padding:10px;
  margin:6px 0;
  border-radius:12px;
  box-shadow:0 0 10px #7f00ff;
}
.itinerary-item.selected{
  background:#00d4ff;
  color:#000;
}

.copy-btn{
  margin-top:10px;
  padding:10px;
  border-radius:10px;
  background:linear-gradient(90deg,#00d4ff,#7f00ff);
  border:none;
  cursor:pointer;
  font-weight:bold;
}

a{color:#00d4ff;text-decoration:underline}

footer{text-align:center;padding:10px;color:#c7bfff}
</style>
</head>

<body>

<div class="warning">⚠️ MAHARASHTRA MODULE — UNDER TESTING ⚠️</div>

<header>
<h1>PlanDaVoyage</h1>
<p>Smart Maharashtra Travel Chat</p>
</header>

<div class="chat-box">
  <div class="messages" id="chatMessages"></div>
  <div class="input-area">
    <input id="chatInput" placeholder="Type your message..." />
    <button onclick="handleInput()">Send</button>
  </div>
</div>

<footer>© 2025 PlanDaVoyage</footer>

<script>
const chat = document.getElementById("chatMessages");
const input = document.getElementById("chatInput");

let mode="finder";
let step=0;
let tripType="";
let people=0;
let itinerary=[];

/* PLACES — unchanged concept */
const places=[
  {name:"Amboli Waterfall",map:"https://www.googlemaps.com/place/Amboli+Waterfall"},
  {name:"Devkund Waterfall",map:"https://www.googlemaps.com/place/Devkund+Waterfall"},
  {name:"Lingmala Waterfall",map:"https://www.googlemaps.com/place/Lingmala+Waterfall"},
  {name:"Pawna Dam",map:"https://www.googlemaps.com/place/Pawna+Dam"},
  {name:"Koyna Dam",map:"https://www.googlemaps.com/place/Koyna+Dam"}
];

/* CHAT HELPERS */
function addBot(text,link=null){
  const div=document.createElement("div");
  div.className="message bot";
  div.innerHTML=link?`${text} <a href="${link}" target="_blank">[Map]</a>`:text;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

function addUser(text){
  const div=document.createElement("div");
  div.className="message user";
  div.textContent=text;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

input.addEventListener("keydown",e=>{
  if(e.key==="Enter") handleInput();
});

/* INITIAL MESSAGES */
addBot("⚠️ This system is under testing");
addBot("Type /finder to find places");
addBot("Type /itinerary to build an itinerary");

/* MAIN HANDLER */
function handleInput(){
  const value=input.value.trim();
  if(!value) return;

  addUser(value);
  input.value="";

  if(value.toLowerCase().includes("thank")){
    addBot("You're most welcome!");
    return;
  }

  if(value==="/finder"){
    resetFinder();
    return;
  }

  if(value==="/itinerary"){
    resetItinerary();
    return;
  }

  if(mode==="finder"){
    handleFinder(value);
    return;
  }

  if(mode==="itinerary"){
    handleItinerary(value);
  }
}

/* ===== ORIGINAL FINDER LOGIC (RESTORED) ===== */
function resetFinder(){
  mode="finder";
  step=0;
  tripType="";
  people=0;
  addBot("Bachelor or family trip?");
}

function handleFinder(value){
  value=value.toLowerCase();

  if(step===0){
    if(value!=="bachelor" && value!=="family"){
      addBot("Please type bachelor or family");
      return;
    }
    tripType=value;
    step=1;
    addBot("How many people? (2 to 7)");
    return;
  }

  if(step===1){
    const num=parseInt(value);
    if(isNaN(num)||num<2||num>7){
      addBot("Enter a valid number from 2 to 7");
      return;
    }
    people=num;
    generateFinderResults();
    step=0;
  }
}

function generateFinderResults(){
  addBot("✅ Best matches:");
  places.forEach(p=>addBot(p.name,p.map));
}

/* ===== ITINERARY (UNCHANGED STYLE) ===== */
function resetItinerary(){
  mode="itinerary";
  itinerary=[];
  addBot("Type place name to add to itinerary");
}

function handleItinerary(value){
  const matches=places.filter(p=>p.name.toLowerCase().includes(value.toLowerCase()));
  if(!matches.length){
    addBot("No matching locations");
    return;
  }

  matches.forEach(p=>{
    const div=document.createElement("div");
    div.className="itinerary-item";
    div.textContent=p.name;
    div.onclick=()=>{
      if(itinerary.includes(p)) return;
      itinerary.push(p);
      div.classList.add("selected");
      addBot("Added "+p.name,p.map);
    };
    chat.appendChild(div);
    chat.scrollTop=chat.scrollHeight;
  });
}

/* FORCE RELOAD → INDEX */
window.addEventListener("pageshow",e=>{
  if(e.persisted || performance.getEntriesByType("navigation")[0].type==="reload"){
    location.replace("index.html");
  }
});
</script>

</body>
</html>
